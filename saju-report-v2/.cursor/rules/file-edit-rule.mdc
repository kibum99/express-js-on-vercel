---
description: "파일 편집 도구 사용 시 실패 방지 및 재동기화 규칙. 편집 실패 시 파일을 재읽어 최신 상태를 확인하고 캐시에 의존하지 않도록 합니다."
alwaysApply: true
---

# 파일 편집 및 동기화 규칙

## High Priority: 파일 편집 실패 시 재동기화 필수

파일 편집 도구(tool)를 사용할 때 다음 규칙을 반드시 준수하세요:

## 핵심 원칙

### 1. 편집 실패 시 즉시 재동기화
- 파일 편집 도구가 실패하거나 "변경사항이 없음"을 보고하면, **반드시 해당 파일을 다시 읽어서** 최신 상태를 확인하세요
- 캐시된 버전을 가정하지 마세요
- 파일을 다시 읽은 후에만 편집을 재시도하세요

### 2. 편집 전 파일 상태 확인
- 중요한 편집을 수행하기 전에 파일의 현재 상태를 확인하세요
- 특히 다른 에이전트나 프로세스가 동시에 수정할 수 있는 파일의 경우 더욱 중요합니다

### 3. 편집 실패 처리 절차
```
편집 시도 → 실패/변경사항 없음 감지 → 파일 재읽기 → 상태 분석 → 재시도 또는 대안 제시
```

### 4. 캐시 사용 금지
- 파일 편집 도구 사용 시 캐시된 파일 내용에 의존하지 마세요
- 항상 최신 파일 내용을 읽어서 확인한 후 편집하세요
- **설명만 제공하고 실제 편집을 하지 않는 것을 절대 피하세요**
- 반드시 실제 편집 도구(`search_replace`, `write`, `edit_notebook` 등)를 사용하여 변경사항을 적용하세요

### 4-1. 코드 변경 요청 시 즉시 적용
- 사용자가 코드 변경을 요청하면, **코드를 먼저 보여주고 설명한 다음 수정하는 중간 단계를 생략**하고 바로 코드 수정 도구를 사용하세요
- 코드 블록으로 변경사항을 보여주고 "이제 파일에 적용하겠습니다"라고 말하는 방식은 피하세요
- 변경 요청을 받으면 즉시 `read_file`로 파일을 읽고, 바로 `search_replace` 또는 `write` 도구를 사용하여 변경사항을 적용하세요
- 변경사항에 대한 설명은 코드 수정 도구를 사용한 **이후**에 간단히 제공하세요

### 5. 에러 처리 절차
파일 편집이 실패하면 다음 순서로 처리하세요:

1. 즉시 `read_file` 도구를 사용하여 파일을 다시 읽으세요
2. 파일 내용이 예상과 다른지 확인하세요
3. 파일이 존재하는지, 권한이 있는지 확인하세요
4. 문제를 분석한 후 적절한 조치를 취하세요
5. 재시도 시 최신 파일 내용을 기반으로 편집하세요

### 6. 다중 편집 시 주의사항
- 여러 파일을 동시에 편집할 때는 각 파일의 최신 상태를 확인하세요
- 한 파일의 편집이 다른 파일에 영향을 줄 수 있는 경우, 관련 파일들도 함께 확인하세요

## 일반 파일 편집 가이드라인

- 파일을 편집하기 전에 `read_file`로 현재 내용을 확인하세요
- 큰 파일의 경우 필요한 부분만 읽되, 편집할 부분의 충분한 컨텍스트를 포함하세요
- 편집 후에는 변경사항이 올바르게 적용되었는지 확인하세요
- 린터 오류가 발생하면 수정하세요

## 금지 사항

❌ **절대 하지 말아야 할 것들:**
- 편집 실패 후 캐시된 내용으로 재시도
- 설명만 제공하고 실제 편집 도구를 사용하지 않음
- 파일을 읽지 않고 편집 시도
- 에러 발생 시 파일 상태 확인 없이 재시도
- 코드 변경 요청 시 코드를 먼저 보여주고 설명한 다음 수정하는 중간 단계 수행
- "이제 파일에 적용하겠습니다"라고 말하고 나서 실제 수정 도구 사용

✅ **반드시 해야 할 것들:**
- 편집 실패 시 즉시 파일 재읽기
- 최신 파일 내용 확인 후 편집
- 실제 편집 도구를 사용하여 변경사항 적용
- 에러 발생 시 체계적인 문제 분석 및 해결
- 코드 변경 요청 시 중간 설명 단계 없이 바로 코드 수정 도구 사용
- 변경사항 설명은 코드 수정 도구 사용 이후에 제공
